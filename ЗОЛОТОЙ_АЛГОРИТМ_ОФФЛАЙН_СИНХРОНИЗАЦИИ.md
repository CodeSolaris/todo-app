# üöÄ –ó–û–õ–û–¢–û–ô –ê–õ–ì–û–†–ò–¢–ú –û–§–§–õ–ê–ô–ù-–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò (REST API)

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —ç—Ç–∞–ª–æ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ñ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞ –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –°–ª–µ–¥—É–π —ç—Ç–æ–º—É –≥–∞–π–¥—É, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ —Ç–≤–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–æ–ø–∞–¥–∞–ª–∏.

---

## üíé –§–∏–ª–æ—Å–æ—Ñ–∏—è: "–°–Ω–∞—á–∞–ª–∞ –ª–æ–∫–∞–ª—å–Ω–æ, –ø–æ—Ç–æ–º –≤ –æ–±–ª–∞–∫–æ"

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å —Å–ø–∏–Ω–Ω–µ—Ä—ã –∏–ª–∏ –æ—à–∏–±–∫–∏ —Å–µ—Ç–∏. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—è –±—Ä–∞—É–∑–µ—Ä –∫–∞–∫ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.

---

## üèó –®–ê–ì 1: –î–µ—Ç–µ–∫—Ç–æ—Ä –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (Network Observer)

–°–æ–∑–¥–∞–π –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å (Context), –∫–æ—Ç–æ—Ä—ã–π –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç `navigator.onLine`.

- **–°–æ–±—ã—Ç–∏—è:** `window.addEventListener('online')` –∏ `offline`.
- **–ó–∞—á–µ–º:** –ß—Ç–æ–±—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–Ω–∞–ª–æ, –∫–æ–≥–¥–∞ –ø–æ—Ä–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤ —Ä–µ–∂–∏–º –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∞ –∫–æ–≥–¥–∞ ‚Äî –≤ —Ä–µ–∂–∏–º –≤—ã–≥—Ä—É–∑–∫–∏.

---

## ‚ö°Ô∏è –®–ê–ì 2: –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π UI (UI First)

–õ—é–±–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (Add, Update, Delete) –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É —Ü–∏–∫–ª—É:

1. **React State:** –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.
2. **LocalStorage:** –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ –≤ –ø–∞–º—è—Ç—å –±—Ä–∞—É–∑–µ—Ä–∞.
3. **API Call:** –¢–æ–ª—å–∫–æ —Ç–µ–ø–µ—Ä—å –¥–µ–ª–∞–µ–º `fetch`. –ï—Å–ª–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –Ω–µ—Ç –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä —É–ø–∞–ª ‚Äî **–Ω–µ –æ—Ç–∫–∞—Ç—ã–≤–∞–π –∏–∑–º–µ–Ω–µ–Ω–∏—è!** –ü—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–≤—å –∏—Ö –≤ LocalStorage —Å –ø–æ–º–µ—Ç–∫–æ–π.

---

## üîñ –®–ê–ì 3: –°–∏—Å—Ç–µ–º–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ (Sync Tokens)

–ß—Ç–æ–±—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–Ω–∏–º–∞–ª–æ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ –¥–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –∏—Å–ø–æ–ª—å–∑—É–π —Ç—Ä–∏ –º–∞—Ä–∫–µ—Ä–∞:

1. **–í—Ä–µ–º–µ–Ω–Ω—ã–µ ID (–¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è):** –ù–æ–≤—ã–º –∑–∞–ø–∏—Å—è–º –¥–∞–≤–∞–π ID –≤–∏–¥–∞ `temp_173627...`.
2. **–§–ª–∞–≥ `synced: false` (–¥–ª—è –ø—Ä–∞–≤–æ–∫):** –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –∏–∑–º–µ–Ω–µ–Ω–∞ –æ—Ñ—Ñ–ª–∞–π–Ω, –ø–æ—Å—Ç–∞–≤—å –µ–π —ç—Ç–æ—Ç —Ñ–ª–∞–≥.
3. **–û—á–µ—Ä–µ–¥—å —É–¥–∞–ª–µ–Ω–∏–π (`pendingDeletes`):** –°–æ–∑–¥–∞–π –≤ LocalStorage –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª—é—á (–º–∞—Å—Å–∏–≤), –∫—É–¥–∞ –∑–∞–ø–∏—Å—ã–≤–∞–π ID —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ, –∏–Ω–∞—á–µ —É–¥–∞–ª–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ ¬´–≤–æ—Å–∫—Ä–µ—Å–Ω—É—Ç¬ª –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–≥—Ä—É–∑–∫–µ.

---

## üîÑ –®–ê–ì 4: –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏–º–∏—Ä–µ–Ω–∏—è (Reconciliation)

–ö–æ–≥–¥–∞ –¥–µ—Ç–µ–∫—Ç–æ—Ä –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≥–æ–≤–æ—Ä–∏—Ç `online: true`, –∑–∞–ø—É—Å–∫–∞–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

### –ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π (—Å—Ç—Ä–æ–≥–æ –≤ —ç—Ç–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏!):

1. **SYNC DELETES:** –ü—Ä–æ–π–¥–∏—Å—å –ø–æ —Å–ø–∏—Å–∫—É `pendingDeletes` –∏ –æ—Ç–ø—Ä–∞–≤—å `DELETE` –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞ –æ—á–∏—â–∞–π —Å–ø–∏—Å–æ–∫.
2. **SYNC NEW/UPDATED:** –ü—Ä–æ–π–¥–∏—Å—å –ø–æ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Å–ø–∏—Å–∫—É –≤ LocalStorage.
   - –ï—Å–ª–∏ ID –≤—Ä–µ–º–µ–Ω–Ω—ã–π (`temp_...`) -> –æ—Ç–ø—Ä–∞–≤—å `POST`. –ü–æ–ª—É—á–∏–≤ –æ—Ç–≤–µ—Ç, –∑–∞–º–µ–Ω–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–π ID –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω—ã–π.
   - –ï—Å–ª–∏ –µ—Å—Ç—å —Ñ–ª–∞–≥ `synced: false` -> –æ—Ç–ø—Ä–∞–≤—å `PUT`.
3. **FINAL FETCH:** –°–¥–µ–ª–∞–π —Ñ–∏–Ω–∞–ª—å–Ω—ã–π `GET` –∑–∞–ø—Ä–æ—Å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏–¥–µ–∞–ª—å–Ω—É—é –∫–æ–ø–∏—é –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ –æ–±–Ω–æ–≤–∏—Ç—å LocalStorage.

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ (Pitfalls)

1. **–ù–∏–∫–∞–∫–æ–≥–æ –¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –ù–µ —É–¥–∞–ª—è–π –≤—Å—ë –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, —á—Ç–æ–±—ã –∑–∞–ª–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –∫–æ–ø–∏—é. –≠—Ç–æ —É–±—å–µ—Ç –¥–∞–Ω–Ω—ã–µ, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Å –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.
2. **Stable Identifiers:** –í—Å–µ–≥–¥–∞ –∑–∞–º–µ–Ω—è–π –≤—Ä–µ–º–µ–Ω–Ω—ã–µ ID –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –¥—É–±–ª–µ–π.
3. **Error Handling:** –ï—Å–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏ —É–ø–∞–ª–∞, –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–π –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å. –ü–æ–º–µ—Ç—å –æ—à–∏–±–∫—É –∏ –∏–¥–∏ –¥–∞–ª—å—à–µ.
4. **Race Conditions:** –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã—Å—Ç—Ä–æ –≤–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ, –ø–æ–∫–∞ –∏–¥–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –∏—Å–ø–æ–ª—å–∑—É–π `isSyncing` —Ñ–ª–∞–≥ (Ref), —á—Ç–æ–±—ã –Ω–µ –∑–∞—Ç–µ—Ä–µ—Ç—å –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–æ–º –æ—Ç —Å—Ç–∞—Ä–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.

---

_–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω —Ç–≤–æ–∏–º AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º Antigravity._
